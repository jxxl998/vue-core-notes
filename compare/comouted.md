## æ•°æ®è®¡ç®—

### ä½¿ç”¨æ–¹å¼å¯¹æ¯”

- Vue2

  - computed å’Œ data åŒçº§é…ç½®
  - é€šè¿‡ this è®¿é—®

- Vue3
  - å¯¼å…¥`computed`API
  - å®šä¹‰çš„å˜é‡ï¼Œé€šè¿‡`.value`è¯»å–

### ä¸ function çš„å¯¹æ¯”

- æ€§èƒ½ä¼˜åŠ¿ï¼Œ`computed` å…·æœ‰ç¼“å­˜ï¼Œä½“ç°åœ¨å¤„ç†å·¨å¤§æ•°æ®ä¾èµ–è®¡ç®—çš„æ€§èƒ½å¼€é”€ï¼Œé¿å…å¤šæ¬¡æ‰§è¡Œ `getter`
- ä¹¦å†™ç»Ÿä¸€
  - Vue3 ä¸­çš„ `computed` å’Œå®šä¹‰çš„ `ref` å˜é‡éƒ½æ˜¯é€šè¿‡`.value` å»è¯»å–å€¼ï¼Œæ— è®ºæ˜¯åœ¨ `template`ï¼Œè¿˜æ˜¯åœ¨ `script` ä¸­ï¼Œä¿æŒä¸€è‡´æ€§
  - function çš„è¯åŸºæœ¬è¦é€šè¿‡è°ƒç”¨æ‰å¯ä»¥è·å–å…¶ return çš„å€¼

ä»¥ä¸Šï¼Œå¦‚æœ**ä½¿ç”¨çš„æ•°æ®ä¸éœ€è¦å…·æœ‰å“åº”æ€§**ï¼Œå¯ä»¥ç®€å•ä½¿ç”¨ function çš„è¿”å›å€¼å°±å¯ä»¥äº†ï¼ŒåŸå› å¦‚ä¸‹ï¼š

- åªä¼šæ›´æ–°å“åº”å¼æ•°æ®çš„è®¡ç®—

  ```js
  // è·å–æœ€æ–°æ—¶é—´
  const currentTime = computed(() => new Date());
  console.log(currentTime);
  // å½“å‰æ—¶é—´

  setTimeout(() => {
    console.log(currentTime);
  }, 2000);
  // 2sä¹‹åè¿˜æ˜¯ä¼šè¾“å‡ºğŸ‘†çš„å½“å‰æ—¶é—´ï¼Œå› ä¸ºä¸æ˜¯å“åº”å¼æ•°æ®ï¼Œæ‰€ä»¥è·å–æœ€æ–°æ—¶é—´éœ€è¦ç”¨æ™®é€šå‡½æ•°å»è¿”å›
  ```

- æ•°æ®æ˜¯åªè¯»çš„
  ä¸èƒ½èµ‹å€¼ï¼Œä¼šæŠ¥é”™  
  ä¸è¿‡å¿…è¦æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨ `setter`

### åº”ç”¨åœºæ™¯

- æ•°æ®æ‹¼æ¥å’Œè®¡ç®—
- å¤ç”¨ç»„ä»¶åŠ¨æ€æ•°æ®
  - åŠ¨æ€æ‹¼æ¥æ¥å£
- è·å–å¤šå±‚çº§å¯¹è±¡çš„å€¼ï¼Œç»“åˆ `try/catch` ä½¿ç”¨

  ```js
  // ä¾‹å­æ¯”è¾ƒæç«¯ï¼Œä½†åœ¨ Vuex è¿™ç§å¤§å‹æ•°æ®æ ‘ä¸Šï¼Œä¹Ÿä¸æ˜¯å®Œå…¨ä¸å¯èƒ½å­˜åœ¨
  const foo = computed(() => {
    // æ­£å¸¸æƒ…å†µä¸‹è¿”å›éœ€è¦çš„æ•°æ®
    try {
      return store.state.foo3.foo2.foo1.foo;
    } catch (e) {
      // å¤„ç†å¤±è´¥åˆ™è¿”å›ä¸€ä¸ªé»˜è®¤å€¼
      return '';
    }
  });
  ```

- ä¸åŒç±»å‹æ•°æ®æ ¼å¼è½¬æ¢

  - éœ€æ±‚ç±»ä¼¼äºï¼Œè®©ç”¨æˆ·åœ¨è¾“å…¥æ¡†é‡Œï¼ŒæŒ‰ä¸€å®šçš„æ ¼å¼å¡«å†™æ–‡æœ¬ï¼Œæ¯”å¦‚ç”¨è‹±æ–‡é€—å·`,`éš”å¼€æ¯ä¸ªè¯ï¼Œç„¶åä¿å­˜çš„æ—¶å€™ï¼Œæ˜¯ç”¨æ•°ç»„çš„æ ¼å¼æäº¤ç»™æ¥å£

  ```js
  const result = ref([]);

  const inputValue = computed({
    // è¯»å–è½¬ä¸ºå­—ç¬¦ä¸²
    get() {
      return result.value.join(',');
    },
    // ç”¨æˆ·è¾“å…¥æ—¶å€™åˆ‡å‰²æ•°ç»„
    set(newValue) {
      result.value = newValue.split(',');
    },
  });

  // åœ¨å¯¹inputValueèµ‹å€¼çš„æ—¶å€™æ‰ä¼š
  ```

  ```html
  <input
    type="text"
    v-model="inputValue"
    placeholder="è¯·è¾“å…¥æ ‡ç­¾ï¼Œå¤šä¸ªæ ‡ç­¾ç”¨è‹±æ–‡é€—å·éš”å¼€"
  />
  ```
